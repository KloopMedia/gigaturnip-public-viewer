(this["webpackJsonpgigaturnip-public-viewer"]=this["webpackJsonpgigaturnip-public-viewer"]||[]).push([[0],{292:function(e,t,n){},293:function(e,t,n){},517:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(61),r=n.n(s),i=(n(292),n(293),n(11)),o=n(577),l=n(578),u=n(100),b=n(261),d=n(7),j=n(582),O=n(571),h=n(584),p=n(583),f=n(581),g=n(274),m=n.n(g),x=n(83),v=n.n(x),k=n(127),S=n(182),y=(n(487),n(129)),w=n.n(y),C="api/v1/taskstages/",_="api/v1/tasks/",E=w.a.create({baseURL:"https://journal-bb5e3.uc.r.appspot.com/"});E.interceptors.request.use((function(e){localStorage.getItem("token");return e}),(function(e){return Promise.reject(e)}));var T=E,F=n(5),I=n(72);I.a.initializeApp({apiKey:"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ",authDomain:"gigaturnip-b6b5b.firebaseapp.com",projectId:"gigaturnip-b6b5b",storageBucket:"gigaturnip-b6b5b.appspot.com",messagingSenderId:"414429242328",appId:"1:414429242328:web:a4685f5ac6895ea767c8ad",measurementId:"G-Y8JTEJMTET"});new I.a.auth.GoogleAuthProvider;I.a.firestore().settings({ignoreUndefinedProperties:!0});var L=I.a,N=n(271),A=n(575),B=n(3),q=function(e){var t=e.schema,n=e.value,c=Object(a.useState)({}),s=Object(i.a)(c,2),r=s[0],o=s[1],l=Object(a.useState)(""),b=Object(i.a)(l,2),d=b[0],j=b[1],O=Object(a.useState)(!1),h=Object(i.a)(O,2),p=h[0],f=h[1],g=Object(a.useState)(!1),m=Object(i.a)(g,2),x=m[0],S=m[1],y=Object(a.useState)(""),w=Object(i.a)(y,2),C=w[0],_=w[1],E=Object(a.useState)({}),T=Object(i.a)(E,2),I=T[0],q=T[1];Object(a.useEffect)((function(){if(n&&Object.keys(n).length>0){console.log("value",n);var e=JSON.parse(n);q(e),Object.keys(e).forEach((function(t){D(e[t]).then((function(e){return o((function(n){return Object(u.a)(Object(u.a)({},n),{},Object(F.a)({},t,{url:e,status:"complete"}))}))}))}))}}),[n]);var D=function(e){return L.storage().ref(e).getDownloadURL()},J=function(){var e=Object(k.a)(v.a.mark((function e(t){var n,a,c,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I,console.log("FILE CLICK VALUE",n),!(t in n)){e.next=22;break}return a=n[t],console.log(a),e.next=7,L.storage().ref().child(a).getMetadata();case 7:c=e.sent,s=c.contentType.split("/")[0],console.log("FILE TYPE",s),e.t0=s,e.next="image"===e.t0?13:"video"===e.t0?17:21;break;case 13:return j(r[t].url),_(c.contentType),f(!0),e.abrupt("break",22);case 17:return j(r[t].url),_(c.contentType),S(!0),e.abrupt("break",22);case 21:window.open(r[t].url,"_blank");case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){j(""),_(""),f(!1),S(!1)};return Object(B.jsxs)("div",{children:[p&&Object(B.jsx)(N.a,{src:[d],disableScroll:!1,backgroundStyle:{backgroundColor:"rgba(0,0,0,0.8)"},closeOnClickOutside:!0,onClose:P}),Object(B.jsx)(A.a,{open:x,onClose:P,fullWidth:!0,children:Object(B.jsxs)("video",{height:"360px",controls:!0,children:[Object(B.jsx)("source",{src:d,type:C}),"Your browser does not support the video tag."]})}),Object(B.jsx)("label",{className:"form-label",children:null===t||void 0===t?void 0:t.title}),Object(B.jsx)("br",{}),Object.keys(r).map((function(e,t){return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[Object(B.jsx)("p",{children:e}),"complete"===r[e].status&&Object(B.jsx)("div",{style:{display:"flex",alignItems:"baseline"},children:Object(B.jsx)("button",{onClick:function(){return J(e)},style:{fontSize:"14px",padding:0,margin:"0 10px"},type:"button",className:"btn btn-link text-success",children:"\u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0444\u0430\u0439\u043b"})})]})},e)}))]})},D=n(21),J={customfile:q,autocomplete:function(e){var t,n,c,s=e.id,r=e.placeholder,o=e.required,l=e.readonly,u=e.disabled,b=e.label,d=e.value,j=e.onChange,O=e.onBlur,h=e.onFocus,p=e.autofocus,f=e.options,g=e.schema,m=e.rawErrors,x=void 0===m?[]:m,v=null!==(t=f.searchField)&&void 0!==t?t:"search",k=null!==(n=f.responseField)&&void 0!==n?n:"text",S=null!==(c=null===f||void 0===f?void 0:f.params)&&void 0!==c?c:"",y=Object(a.useState)([]),C=Object(i.a)(y,2),_=C[0],E=C[1],T=function(){if(f.webhook){var e="".concat(f.webhook,"?").concat(v,"=").concat(d+S);w.a.get(e).then((function(e){return e.data})).then((function(e){return E(e.results)})).catch((function(e){return console.log(e)}))}},F="string"===g.type?"text":"".concat(g.type);return Object(B.jsxs)(D.a.Group,{className:"mb-0",children:[Object(B.jsxs)(D.a.Label,{className:x.length>0?"text-danger":"",children:[b||g.title,(b||g.title)&&o?"*":null]}),Object(B.jsx)(D.a.Control,{id:s,placeholder:r,autoFocus:p,required:o,disabled:u,readOnly:l,className:x.length>0?"is-invalid":"",list:"examples_".concat(s),type:F,value:d||0===d?d:"",onChange:function(e){var t=e.target.value;return T(),j(""===t?f.emptyValue:t)},onBlur:function(e){var t=e.target.value;return O(s,t)},onFocus:function(e){var t=e.target.value;return h(s,t)}}),_&&_.length>0?Object(B.jsx)("datalist",{id:"examples_".concat(s),children:_.map((function(e,t){return Object(B.jsx)("option",{value:e[k]},"".concat(e[k],"_").concat(t))}))}):null]})},RadioWidget:function(e){var t=e.id,n=e.schema,a=e.options,c=e.value,s=e.required,r=e.disabled,i=e.readonly,o=e.label,l=e.onChange,u=e.onBlur,b=e.onFocus,d=a.enumOptions,j=a.enumDisabled,O=function(e){var t=e.target.value;return l("boolean"==n.type?"false"!==t:t)},h=function(e){var n=e.target.value;return u(t,n)},p=function(e){var n=e.target.value;return b(t,n)},f=Boolean(a&&a.inline);return Object(B.jsxs)(D.a.Group,{className:"mb-0",children:[Object(B.jsxs)(D.a.Label,{className:"d-block",children:[o||n.title,(o||n.title)&&s?"*":null]}),d.map((function(e,n){var a=Array.isArray(j)&&-1!==j.indexOf(e.value),o=e.value==c;return Object(B.jsx)(D.a.Check,{inline:f,label:e.label,id:"".concat(t,"_").concat(e.label),name:t,type:"radio",disabled:r||a||i,checked:o,required:s,value:e.value,onChange:O,onBlur:h,onFocus:p},n)}))]})},customlink:function(e){var t=e.required,n=e.label,a=e.value,c=e.schema,s=e.rawErrors,r=void 0===s?[]:s;return a?Object(B.jsxs)(D.a.Group,{className:"mb-0",children:[Object(B.jsxs)(D.a.Label,{className:r.length>0?"text-danger":"",children:[n||c.title,(n||c.title)&&t?"*":null]}),Object(B.jsx)("br",{}),Object(B.jsx)("a",{href:a,children:a})]}):null}},P=function(e,t,n){var a=e.results,c=e.count,s=Math.ceil(c/10);console.log("numOfPages",s),console.log("results",a),t(a),n(s)},U=function(e,t){return t&&t>0?"".concat(e,"?limit=10&offset=").concat(10*(t-1)):e},W=function(e,t,n){console.log(t);var a=U("".concat(_,"public/"),t)+"&ordering=created_at";return n&&(n.query&&(a+="&search=".concat(n.query)),n.stage&&(a+="&stage=".concat(n.stage))),console.log("SELECTABLE URL",a),T.get(a).then((function(e){return console.log("getSelectableTasks",e.data),e.data}))},G=function(e){e.id;var t=e.taskData,n=(e.isAssigned,Object(a.useState)({})),c=Object(i.a)(n,2),s=c[0],r=c[1],l=Object(a.useState)({}),u=Object(i.a)(l,2),b=u[0],d=u[1],j=Object(a.useState)({}),O=Object(i.a)(j,2),h=O[0],p=O[1],f=Object(a.useState)(!1),g=Object(i.a)(f,2),m=(g[0],g[1]),x=Object(a.useState)([]),y=Object(i.a)(x,2),w=y[0],C=y[1],_=J;return Object(a.useEffect)((function(){var e=function(){var e=Object(k.a)(v.a.mark((function e(){var n,a,c,s,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(n=t).stage,console.log(n),c=a.json_schema?JSON.parse(a.json_schema):{},s=a.ui_schema?JSON.parse(a.ui_schema):{},i=n.displayed_prev_tasks?n.displayed_prev_tasks:[],o=i.map((function(e){return{responses:e.responses,json_schema:e.stage.json_schema?JSON.parse(e.stage.json_schema):{},ui_schema:e.stage.ui_schema?JSON.parse(e.stage.ui_schema):{}}})),console.log("previousTasks",o),C(o),p(n.responses),r(c),d(s),m(n.complete);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t&&e()}),[t]),Object(B.jsx)(o.a,{container:!0,children:Object(B.jsxs)(o.a,{direction:"row",container:!0,spacing:1,children:[(null===w||void 0===w?void 0:w.length)>0&&Object(B.jsx)(o.a,{container:!0,item:!0,sm:6,xs:12,sx:{display:"block"},children:w.map((function(e,t){var n,a,c;return Object(B.jsx)(S.a,{schema:null!==(n=e.json_schema)&&void 0!==n?n:{},uiSchema:null!==(a=e.ui_schema)&&void 0!==a?a:{},formData:null!==(c=e.responses)&&void 0!==c?c:{},widgets:_,disabled:!0,children:" "},"prev_task_".concat(t))}))}),Object(B.jsx)(o.a,{container:!0,item:!0,sm:(null===w||void 0===w?void 0:w.length)>0?6:12,xs:12,sx:{display:"block"},children:Object(B.jsx)(S.a,{schema:null!==s&&void 0!==s?s:{},uiSchema:null!==b&&void 0!==b?b:{},formData:null!==h&&void 0!==h?h:{},liveOmit:!0,omitExtraData:!0,widgets:_,disabled:!0,children:" "})})]})})},z=n(564),M=["expand"],R=Object(d.a)((function(e){e.expand;var t=Object(b.a)(e,M);return Object(B.jsx)(f.a,Object(u.a)({},t))}))((function(e){var t=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})),K=function(e){var t=e.id,n=e.name,c=e.creatable,s=e.task,r=e.expand,o=e.refreshTasks,l=e.integrated,u=(e.handleAction,e.excluded),b=Object(a.useState)(!1),d=Object(i.a)(b,2),f=d[0],g=d[1],x=Object(a.useState)(null!==l&&void 0!==l&&l),v=Object(i.a)(x,2),k=v[0],S=v[1];Object(a.useEffect)((function(){g(r)}),[r]);return Object(B.jsxs)(j.a,{children:[Object(B.jsx)(O.a,{action:Object(B.jsx)(z.a,{direction:"row",spacing:1,children:Object(B.jsx)(R,{expand:f,onClick:function(){g(!f)},disabled:c,"aria-expanded":f,"aria-label":"show more",children:Object(B.jsx)(m.a,{})})}),sx:{py:1,px:2,background:s.complete?"lightgrey":""},title:n,subheader:"ID: ".concat(t),titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"caption"}}),Object(B.jsx)(p.a,{in:f,timeout:"auto",unmountOnExit:!0,children:Object(B.jsx)(h.a,{children:Object(B.jsx)(G,{id:t,taskData:s,integrated:l,handleAssignment:function(e){S(e)},isAssigned:l?!u:k,refreshTasks:o})})})]})},V=function(e){var t=e.complete,n=e.selectable,c=e.tasks,s=e.creatable,r=e.refreshTasks,u=Object(a.useState)(!1),b=Object(i.a)(u,2),d=b[0],j=b[1];return Object(B.jsxs)(o.a,{container:!0,direction:s?"row":"column",alignItems:"center",justifyContent:s?"flex-start":"center",children:[Object(B.jsx)(l.a,{variant:"contained",onClick:function(){j(!d)},children:d?"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435":"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435"}),c.map((function(e){var a=e.id.toString(),c=e.stage.name,i=e.stage.description;return Object(B.jsx)(o.a,{item:!0,sx:{p:1,width:"100%"},children:Object(B.jsx)(K,{id:a,name:c,description:i,complete:t,selectable:n,creatable:s,task:e,expand:d,refreshTasks:r})},e.id)}))]})},Y=n(586),H=n(568),Q=n(585),X=n(572),Z=n(589),$=n(573),ee=n(566),te=n(570),ne=function(e){e.campaign;var t=e.onFilter,n=Object(a.useState)(""),c=Object(i.a)(n,2),s=c[0],r=(c[1],Object(a.useState)("")),o=Object(i.a)(r,2),u=o[0],b=o[1],d=Object(a.useState)(""),j=Object(i.a)(d,2),O=(j[0],j[1],Object(a.useState)([])),h=Object(i.a)(O,2),p=(h[0],h[1],Object(a.useState)([])),f=Object(i.a)(p,2),g=f[0],m=f[1],x=Object(a.useState)({}),v=Object(i.a)(x,2),k=(v[0],v[1],Object(a.useState)({})),S=Object(i.a)(k,2),y=(S[0],S[1],Object(a.useState)({})),w=Object(i.a)(y,2),_=(w[0],w[1],Object(a.useState)("")),E=Object(i.a)(_,2),F=E[0],I=E[1];Object(a.useEffect)((function(){T.get("".concat(C,"public/")).then((function(e){return e.data})).then((function(e){return m(e)}))}),[s]);return Object(B.jsxs)(Q.a,{children:[Object(B.jsx)(Y.a,{sx:{m:1,minWidth:120},children:Object(B.jsx)(X.a,{id:"outlined-basic",label:"Search Field",variant:"outlined",fullWidth:!0,onChange:function(e){I(e.target.value)}})}),Object(B.jsxs)(Z.a,{sx:{m:1,minWidth:120},children:[Object(B.jsx)($.a,{id:"select-stage-filter",children:"Stage"}),Object(B.jsxs)(ee.a,{labelId:"select-stage-label",id:"select-stage",value:u,label:"Stage",onChange:function(e){b(e.target.value)},children:[Object(B.jsx)(te.a,{value:"",children:Object(B.jsx)("em",{children:"None"})}),g.map((function(e){return Object(B.jsx)(te.a,{value:e.id,children:e.name},"filter_stage_".concat(e.id))}))]})]}),Object(B.jsx)(l.a,{sx:{mx:1,mb:2},variant:"contained",onClick:function(){t(F,u)},children:"\u041f\u043e\u0438\u0441\u043a"})]})},ae=function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),s=n[0],r=n[1],l=Object(a.useState)(0),u=Object(i.a)(l,2),b=u[0],d=u[1],j=c.a.useState(1),O=Object(i.a)(j,2),h=O[0],p=O[1],f=Object(a.useState)(null),g=Object(i.a)(f,2),m=g[0],x=g[1],v="4",k=function(){W(0,1,m).then((function(e){return P(e,r,d)}))};return Object(a.useEffect)((function(){k()}),[]),Object(B.jsxs)(o.a,{sx:{width:"70%",minWidth:"400px",margin:"0 auto",display:"block"},children:[Object(B.jsx)(Y.a,{pb:2,children:Object(B.jsx)(ne,{campaign:v,onFilter:function(e,t){console.log(e,t);var n=e||t?{query:e,stage:t}:null;W(0,1,n).then((function(e){e.count>0?(x(n),p(1),P(e,r,d)):(x(null),alert("\u041d\u0435\u0442 \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0442\u0430\u0441\u043a\u043e\u0432"))}))}})}),Object(B.jsx)(V,{selectable:!0,tasks:s,refreshTasks:k}),Object(B.jsx)(Y.a,{pb:2,display:"flex",justifyContent:"center",children:Object(B.jsx)(H.a,{count:b,page:h,onChange:function(e,t){p(t),t&&W(0,t,m).then((function(e){return P(e,r,d)}))},showFirstButton:!0,showLastButton:!0})})]})},ce=function(){return Object(B.jsx)("div",{children:Object(B.jsx)(ae,{})})},se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,590)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(B.jsx)(ce,{}),document.getElementById("root")),se()}},[[517,1,2]]]);
//# sourceMappingURL=main.7114b394.chunk.js.map