(this["webpackJsonpgigaturnip-public-viewer"]=this["webpackJsonpgigaturnip-public-viewer"]||[]).push([[0],{271:function(e,t,n){},272:function(e,t,n){},495:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(52),r=n.n(s),o=(n(271),n(272),n(15)),i=n(532),l=n(533),u=n(88),b=n(242),d=n(10),j=n(536),p=n(530),h=n(538),O=n(537),f=n(535),g=n(257),m=n.n(g),v=n(72),x=n.n(v),k=n(113),y=n(161),S=(n(466),n(115)),w=n.n(S),C="api/v1/tasks/",_=w.a.create({baseURL:"https://journal-bb5e3.uc.r.appspot.com/"});_.interceptors.request.use((function(e){localStorage.getItem("token");return e}),(function(e){return Promise.reject(e)}));var E=_,T=n(9),L=n(63);L.a.initializeApp({apiKey:"AIzaSyCXiwOUNsbzKH7sbSAZrqA9f7VOeCMdUOQ",authDomain:"gigaturnip-b6b5b.firebaseapp.com",projectId:"gigaturnip-b6b5b",storageBucket:"gigaturnip-b6b5b.appspot.com",messagingSenderId:"414429242328",appId:"1:414429242328:web:a4685f5ac6895ea767c8ad",measurementId:"G-Y8JTEJMTET"});new L.a.auth.GoogleAuthProvider;L.a.firestore().settings({ignoreUndefinedProperties:!0});var I=L.a,N=n(252),F=n(527),A=n(3),B=function(e){var t=e.schema,n=e.value,c=Object(a.useState)({}),s=Object(o.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(""),b=Object(o.a)(l,2),d=b[0],j=b[1],p=Object(a.useState)(!1),h=Object(o.a)(p,2),O=h[0],f=h[1],g=Object(a.useState)(!1),m=Object(o.a)(g,2),v=m[0],y=m[1],S=Object(a.useState)(""),w=Object(o.a)(S,2),C=w[0],_=w[1],E=Object(a.useState)({}),L=Object(o.a)(E,2),B=L[0],D=L[1];Object(a.useEffect)((function(){if(n&&Object.keys(n).length>0){console.log("value",n);var e=JSON.parse(n);D(e),Object.keys(e).forEach((function(t){q(e[t]).then((function(e){return i((function(n){return Object(u.a)(Object(u.a)({},n),{},Object(T.a)({},t,{url:e,status:"complete"}))}))}))}))}}),[n]);var q=function(e){return I.storage().ref(e).getDownloadURL()},J=function(){var e=Object(k.a)(x.a.mark((function e(t){var n,a,c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=B,console.log("FILE CLICK VALUE",n),!(t in n)){e.next=22;break}return a=n[t],console.log(a),e.next=7,I.storage().ref().child(a).getMetadata();case 7:c=e.sent,s=c.contentType.split("/")[0],console.log("FILE TYPE",s),e.t0=s,e.next="image"===e.t0?13:"video"===e.t0?17:21;break;case 13:return j(r[t].url),_(c.contentType),f(!0),e.abrupt("break",22);case 17:return j(r[t].url),_(c.contentType),y(!0),e.abrupt("break",22);case 21:window.open(r[t].url,"_blank");case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){j(""),_(""),f(!1),y(!1)};return Object(A.jsxs)("div",{children:[O&&Object(A.jsx)(N.a,{src:[d],disableScroll:!1,backgroundStyle:{backgroundColor:"rgba(0,0,0,0.8)"},closeOnClickOutside:!0,onClose:P}),Object(A.jsx)(F.a,{open:v,onClose:P,fullWidth:!0,children:Object(A.jsxs)("video",{height:"360px",controls:!0,children:[Object(A.jsx)("source",{src:d,type:C}),"Your browser does not support the video tag."]})}),Object(A.jsx)("label",{className:"form-label",children:null===t||void 0===t?void 0:t.title}),Object(A.jsx)("br",{}),Object.keys(r).map((function(e,t){return Object(A.jsx)("div",{children:Object(A.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[Object(A.jsx)("p",{children:e}),"complete"===r[e].status&&Object(A.jsx)("div",{style:{display:"flex",alignItems:"baseline"},children:Object(A.jsx)("button",{onClick:function(){return J(e)},style:{fontSize:"14px",padding:0,margin:"0 10px"},type:"button",className:"btn btn-link text-success",children:"\u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0444\u0430\u0439\u043b"})})]})},e)}))]})},D=n(19),q={customfile:B,autocomplete:function(e){var t,n,c,s=e.id,r=e.placeholder,i=e.required,l=e.readonly,u=e.disabled,b=e.label,d=e.value,j=e.onChange,p=e.onBlur,h=e.onFocus,O=e.autofocus,f=e.options,g=e.schema,m=e.rawErrors,v=void 0===m?[]:m,x=null!==(t=f.searchField)&&void 0!==t?t:"search",k=null!==(n=f.responseField)&&void 0!==n?n:"text",y=null!==(c=null===f||void 0===f?void 0:f.params)&&void 0!==c?c:"",S=Object(a.useState)([]),C=Object(o.a)(S,2),_=C[0],E=C[1],T=function(){if(f.webhook){var e="".concat(f.webhook,"?").concat(x,"=").concat(d+y);w.a.get(e).then((function(e){return e.data})).then((function(e){return E(e.results)})).catch((function(e){return console.log(e)}))}},L="string"===g.type?"text":"".concat(g.type);return Object(A.jsxs)(D.a.Group,{className:"mb-0",children:[Object(A.jsxs)(D.a.Label,{className:v.length>0?"text-danger":"",children:[b||g.title,(b||g.title)&&i?"*":null]}),Object(A.jsx)(D.a.Control,{id:s,placeholder:r,autoFocus:O,required:i,disabled:u,readOnly:l,className:v.length>0?"is-invalid":"",list:"examples_".concat(s),type:L,value:d||0===d?d:"",onChange:function(e){var t=e.target.value;return T(),j(""===t?f.emptyValue:t)},onBlur:function(e){var t=e.target.value;return p(s,t)},onFocus:function(e){var t=e.target.value;return h(s,t)}}),_&&_.length>0?Object(A.jsx)("datalist",{id:"examples_".concat(s),children:_.map((function(e,t){return Object(A.jsx)("option",{value:e[k]},"".concat(e[k],"_").concat(t))}))}):null]})},RadioWidget:function(e){var t=e.id,n=e.schema,a=e.options,c=e.value,s=e.required,r=e.disabled,o=e.readonly,i=e.label,l=e.onChange,u=e.onBlur,b=e.onFocus,d=a.enumOptions,j=a.enumDisabled,p=function(e){var t=e.target.value;return l("boolean"==n.type?"false"!==t:t)},h=function(e){var n=e.target.value;return u(t,n)},O=function(e){var n=e.target.value;return b(t,n)},f=Boolean(a&&a.inline);return Object(A.jsxs)(D.a.Group,{className:"mb-0",children:[Object(A.jsxs)(D.a.Label,{className:"d-block",children:[i||n.title,(i||n.title)&&s?"*":null]}),d.map((function(e,n){var a=Array.isArray(j)&&-1!==j.indexOf(e.value),i=e.value==c;return Object(A.jsx)(D.a.Check,{inline:f,label:e.label,id:"".concat(t,"_").concat(e.label),name:t,type:"radio",disabled:r||a||o,checked:i,required:s,value:e.value,onChange:p,onBlur:h,onFocus:O},n)}))]})},customlink:function(e){var t=e.required,n=e.label,a=e.value,c=e.schema,s=e.rawErrors,r=void 0===s?[]:s;return a?Object(A.jsxs)(D.a.Group,{className:"mb-0",children:[Object(A.jsxs)(D.a.Label,{className:r.length>0?"text-danger":"",children:[n||c.title,(n||c.title)&&t?"*":null]}),Object(A.jsx)("br",{}),Object(A.jsx)("a",{href:a,children:a})]}):null}},J=function(e,t,n){var a=e.results,c=e.count,s=Math.ceil(c/10);console.log("numOfPages",s),console.log("results",a),t(a),n(s)},P=function(e,t){return t&&t>0?"".concat(e,"?limit=10&offset=").concat(10*(t-1)):e},U=function(e,t,n){console.log(t);var a=P("".concat(C,"public/"),t);return n&&(n.query&&(a+="&task_responses=".concat(n.query)),n.stage&&(a+="&stage=".concat(n.stage))),console.log("SELECTABLE URL",a),E.get(a).then((function(e){return console.log("getSelectableTasks",e.data),e.data}))},G=function(e){e.id;var t=e.taskData,n=e.isAssigned,c=Object(a.useState)({}),s=Object(o.a)(c,2),r=s[0],l=s[1],u=Object(a.useState)({}),b=Object(o.a)(u,2),d=b[0],j=b[1],p=Object(a.useState)({}),h=Object(o.a)(p,2),O=h[0],f=h[1],g=Object(a.useState)(!1),m=Object(o.a)(g,2),v=m[0],S=m[1],w=Object(a.useState)([]),C=Object(o.a)(w,2),_=C[0],E=C[1],T=q;return Object(a.useEffect)((function(){var e=function(){var e=Object(k.a)(x.a.mark((function e(){var n,a,c,s,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(n=t).stage,console.log(n),c=a.json_schema?JSON.parse(a.json_schema):{},s=a.ui_schema?JSON.parse(a.ui_schema):{},r=[].map((function(e){return{responses:e.responses,json_schema:e.stage.json_schema?JSON.parse(e.stage.json_schema):{},ui_schema:e.stage.ui_schema?JSON.parse(e.stage.ui_schema):{}}})),console.log("previousTasks",r),E(r),f(n.responses),l(c),j(s),S(n.complete);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t&&e()}),[t]),Object(A.jsx)(i.a,{container:!0,children:Object(A.jsxs)(i.a,{direction:"row",container:!0,spacing:1,children:[(null===_||void 0===_?void 0:_.length)>0&&Object(A.jsx)(i.a,{container:!0,item:!0,sm:6,xs:12,sx:{display:"block"},children:_.map((function(e,t){var n,a,c;return Object(A.jsx)(y.a,{schema:null!==(n=e.json_schema)&&void 0!==n?n:{},uiSchema:null!==(a=e.ui_schema)&&void 0!==a?a:{},formData:null!==(c=e.responses)&&void 0!==c?c:{},widgets:T,disabled:!0,children:" "},"prev_task_".concat(t))}))}),Object(A.jsx)(i.a,{container:!0,item:!0,sm:(null===_||void 0===_?void 0:_.length)>0?6:12,xs:12,sx:{display:"block"},children:Object(A.jsx)(y.a,{schema:null!==r&&void 0!==r?r:{},uiSchema:null!==d&&void 0!==d?d:{},formData:null!==O&&void 0!==O?O:{},liveOmit:!0,omitExtraData:!0,widgets:T,disabled:v||!n,children:" "})})]})})},z=n(525),M=["expand"],R=Object(d.a)((function(e){e.expand;var t=Object(b.a)(e,M);return Object(A.jsx)(f.a,Object(u.a)({},t))}))((function(e){var t=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})),K=function(e){var t=e.id,n=e.name,c=e.creatable,s=e.task,r=e.expand,i=e.refreshTasks,l=e.integrated,u=(e.handleAction,e.excluded),b=Object(a.useState)(!1),d=Object(o.a)(b,2),f=d[0],g=d[1],v=Object(a.useState)(null!==l&&void 0!==l&&l),x=Object(o.a)(v,2),k=x[0],y=x[1];Object(a.useEffect)((function(){g(r)}),[r]);return Object(A.jsxs)(j.a,{children:[Object(A.jsx)(p.a,{action:Object(A.jsx)(z.a,{direction:"row",spacing:1,children:Object(A.jsx)(R,{expand:f,onClick:function(){g(!f)},disabled:c,"aria-expanded":f,"aria-label":"show more",children:Object(A.jsx)(m.a,{})})}),sx:{py:1,px:2,background:s.complete?"lightgrey":""},title:n,subheader:"ID: ".concat(t),titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"caption"}}),Object(A.jsx)(O.a,{in:f,timeout:"auto",unmountOnExit:!0,children:Object(A.jsx)(h.a,{children:Object(A.jsx)(G,{id:t,taskData:s,integrated:l,handleAssignment:function(e){y(e)},isAssigned:l?!u:k,refreshTasks:i})})})]})},V=function(e){var t=e.complete,n=e.selectable,c=e.tasks,s=e.creatable,r=e.refreshTasks,u=Object(a.useState)(!1),b=Object(o.a)(u,2),d=b[0],j=b[1];return Object(A.jsxs)(i.a,{container:!0,direction:s?"row":"column",alignItems:"center",justifyContent:s?"flex-start":"center",children:[Object(A.jsx)(l.a,{variant:"contained",onClick:function(){j(!d)},children:d?"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435":"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435"}),c.map((function(e){var a=e.id.toString(),c=e.stage.name,o=e.stage.description;return Object(A.jsx)(i.a,{item:!0,sx:{p:1,width:"100%"},children:Object(A.jsx)(K,{id:a,name:c,description:o,complete:t,selectable:n,creatable:s,task:e,expand:d,refreshTasks:r})},e.id)}))]})},W=n(539),Y=n(529),H=function(e){var t=Object(a.useState)([]),n=Object(o.a)(t,2),s=n[0],r=n[1],l=Object(a.useState)(0),u=Object(o.a)(l,2),b=u[0],d=u[1],j=c.a.useState(1),p=Object(o.a)(j,2),h=p[0],O=p[1],f=Object(a.useState)(null),g=Object(o.a)(f,2),m=g[0],v=(g[1],function(){U(0,1,m).then((function(e){return J(e,r,d)}))});return Object(a.useEffect)((function(){v()}),[]),Object(A.jsxs)(i.a,{sx:{width:"70%",minWidth:"400px",margin:"0 auto",display:"block"},children:[Object(A.jsx)(W.a,{pb:2}),Object(A.jsx)(V,{selectable:!0,tasks:s,refreshTasks:v}),Object(A.jsx)(W.a,{pb:2,display:"flex",justifyContent:"center",children:Object(A.jsx)(Y.a,{count:b,page:h,onChange:function(e,t){O(t),t&&U(0,t,m).then((function(e){return J(e,r,d)}))},showFirstButton:!0,showLastButton:!0})})]})},Q=function(){return Object(A.jsx)("div",{children:Object(A.jsx)(H,{})})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,541)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(A.jsx)(Q,{}),document.getElementById("root")),X()}},[[495,1,2]]]);
//# sourceMappingURL=main.84f7cd7d.chunk.js.map